 @model QLHD.Models.HOPDONG_CHIPHI
@{
    ViewBag.Title = "Sửa HĐ chi phí";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="">
    <div class="page-title">
        <div class="title_left">
            <h3>Sửa hợp đồng chi phí</h3>
            <span style="color: red">@ViewBag.baoloi</span>
        </div>
    </div>
    <div class="clearfix"></div>
    @*@using (Html.BeginForm("EditHDChiPhiPost", "HDChiPhi", new { @HDCHIPHI_ID = @Model.HOPDONG_CHIPHI_ID, @newObj = @Model }))*@
    @using (Html.BeginForm("EditHDChiPhiPost", "HDChiPhi", FormMethod.Post, new { @enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        <div class="row">
            <div class="col-md-12">
                <div class="x_panel" style="">
                    <div class="x_title">
                        <h2>Loại hợp đồng và số hợp đồng</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: right">Loại hợp đồng:</label>
                                </div>
                                <div class="col-md-5">
                                    @Html.DropDownList("ID_LOAIHD_SUB", (IEnumerable<SelectListItem>)ViewBag.MALOAIHD, "--Chọn--", new { @class = "form-control", required = "required" })
                                    <input type="hidden" name="HOPDONG_CHIPHI_ID" id="HOPDONG_CHIPHI_ID" value="@Model.HOPDONG_CHIPHI_ID"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: right">Năm hợp đồng:</label>
                                </div>
                                <div class="col-md-5">
                                    @Html.DropDownList("NAM_HD_ID", (IEnumerable<SelectListItem>)ViewBag.NamHD, "--Chọn--", new { @class = "form-control", required = "required" })

                                </div>
                            </div>
                        </div>


                        <div class="col-md-6" style="margin-top: 15px">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: right">Số hợp đồng:</label>
                                </div>
                                <div class="col-md-5">
                                    <input type="text" class="form-control" name="SO_HD" required="required" value="@Model.SO_HD"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" style="margin-top: 15px">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: right">Ngày lập hợp đồng:</label>
                                </div>
                                <div class="col-md-5">
                                    @*<input type="date" class="form-control" name="NGAY_KT" value="NGAY_HD"/>*@
                                    @if (Model.NGAY_HD.HasValue)
                                    {
                                        <input type="date" class="form-control" name="NGAY_HD" required="required" value="@Model.NGAY_HD.Value.ToString("yyyy-MM-dd")"/>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" style="margin-top: 15px">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: right">Đơn vị lập hợp đồng:</label>
                                </div>
                                <div class="col-md-5">
                                    @Html.DropDownList("DONVI_ID", (IEnumerable<SelectListItem>)ViewBag.DONVI,"--Chọn--", new { @class = "form-control", required = "required" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Bên thuê</h2>
                        @*<div class="col-md-8" style="float:right">
                                    @Html.DropDownList("THUE_BT", (IEnumerable<SelectListItem>)ViewBag.BENTHUEID,"--Chọn bên thuê--", new { @class = "form-control", required = "required", @id = "THUE_BT" })
                                </div>*@
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Tên bên thuê:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="TEN_BT" required="required" id="TEN_BT" value="@Model.TEN_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Địa chỉ:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="DIACHI_BT" required="required" id="DIACHI_BT" value="@Model.DIACHI_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Số điện thoại/FAX:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" class="form-control" name="DIENTHOAI_BT" id="DT_BT1" required="required" value="@Model.DIENTHOAI_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Mã số thuế:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="MSTHUE_BT" id="MSTHUE_BT" required="required" value="@Model.MSTHUE_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Tài khoản:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" id="TAIKHOAN_BT" class="form-control" name="TAIKHOAN_BT" required="required" value="@Model.TAIKHOAN_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Ngân hàng:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" id="NGANHANG_BT" class="form-control" name="NGANHANG_BT" required="required" value="@Model.NGANHANG_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Đại diện:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" id="DAIDIEN_BT" class="form-control" name="DAIDIEN_BT" required="required" value="@Model.DAIDIEN_BT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Chức vụ:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" id="CHUCVU_BT" class="form-control" name="CHUCVU_BT" required="required" value="@Model.CHUCVU_BT"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--DM BTS-->
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Đối tượng hợp đồng</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <div class="control-label col-md-2">
                                    <label style="float: left">DS trạm:</label>
                                </div>
                                <div class="col-md-10">
                                    @Html.DropDownList("BTS_ID_SELECT", (IEnumerable<SelectListItem>)ViewBag.lstBTS, new { @class = "form-control", required = "required", @id = "BTS_ID", multiple = "multiple" })
                                    <input type="hidden" id="BTS_ID_STR" name="BTS_ID" value="@Model.BTS_ID" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Bên cho thuê</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Bên cho thuê:</label>
                                </div>
                                <div class="col-md-8">
                                    <select class="form-control" name="LOAI_CT" id="loai_ct">
                                        <option value="0">--Chọn bên cho thuê--</option>
                                        <option value="1">Doanh nghiệp</option>
                                        <option value="2">Cá nhân</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Tên cho thuê:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="TEN_CT" value="@Model.TEN_CT"/>
                                </div>
                            </div>
                            <div class="form-group" id="daidien_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Đại diện:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="DAIDIEN_CT" value="@Model.DAIDIEN_CT"/>
                                </div>
                            </div>
                            <div class="form-group" id="chucvu_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Chức vụ:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="CHUCVU_CT" value="@Model.CHUCVU_CT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Địa chỉ:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="DIACHI_CT" value="@Model.DIACHI_CT"/>
                                </div>
                            </div>
                            <div class="form-group" id="cmnd_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">CMND:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" class="form-control" name="CMND_CT" value="@Model.CMND_CT"/>
                                </div>
                            </div>
                            <div class="form-group" id="ngaycap_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Ngày cấp:</label>
                                </div>
                                <div class="col-md-8">
                                    
                                    @if (Model.NGAYCAP_CT.HasValue)
                                    {
                                            <input type="date" class="form-control" name="NGAYCAP_CT" value="@Model.NGAYCAP_CT.Value.ToString("yyyy-MM-dd")"/>
                                    }
                                    else
                                    {
                                        <input type="date" class="form-control" name="NGAYCAP_CT" />
                                    }
                                </div>
                            </div>
                            <div class="form-group" id="ngaysinh_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Ngày sinh:</label>
                                </div>
                                <div class="col-md-8">
                                    
                                    @if (Model.NGAYSINH.HasValue)
                                    {
                                            <input type="date" class="form-control" name="NGAYSINH" value="@Model.NGAYSINH.Value.ToString("yyyy-MM-dd")"/>
                                    }
                                    else
                                    {
                                        <input type="date" class="form-control" name="NGAYSINH" />
                                    }
                                </div>
                            </div>
                            <div class="form-group" id="noicap_ct">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Nơi cấp:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="NOICAP_CT" value="@Model.NOICAP_CT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Số điện thoại/FAX:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" class="form-control" name="DIENTHOAI_CT" value="@Model.DIENTHOAI_CT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Mã số thuế:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" class="form-control" name="MSTHUE_CT" value="@Model.MSTHUE_CT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Tài khoản:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="TAIKHOAN_CT" value="@Model.TAIKHOAN_CT"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Ngân hàng:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" name="NGANHANG_CT" value="@Model.NGANHANG_CT"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Panel Gia tri HD-->
            <div class="col-md-6">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Giá trị hợp đồng</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group">                                
                                <div class="control-label col-md-6">
                                    <label style="float: left"><input type="radio" name="optradio" onclick="check_rdo_ct();"> Chi tiết giá thuê/tháng:</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="float: left">1. Giá thuê nhà + anten:</label>
                                </div>
                                <div class="col-md-7">
                                    <input class="form-control" type="number" id="THANG_GT_NHA_ANTEN"  name="THANG_GT_NHA_ANTEN" onchange="reset_sum_nha_anten();" placeholder="0" value="@(Model.THANG_GT_NHA_ANTEN??0)" disabled/>

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="color:darkviolet;float: left;">      +Giá thuê nhà:</label>
                                </div>
                                <div class="col-md-6" style="float:right">
                                    <input class="form-control" style="border-color: darkviolet;color: darkviolet;" type="number" id="THANG_GT_NHA" name="THANG_GT_NHA" onchange="sum_nha_anten();" placeholder="0" value="@(Model.THANG_GT_NHA??0)" disabled/>

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="color:darkviolet;float: left">      +Giá thuê anten:</label>
                                </div>
                                <div class="col-md-6" style="float:right">
                                    <input class="form-control" style="border-color: darkviolet;color: darkviolet;" type="number" id="THANG_GT_ANTEN" name="THANG_GT_ANTEN" onchange="sum_nha_anten();" placeholder="0" value="@(Model.THANG_GT_ANTEN??0)" disabled />

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="float: left">2. MPĐ:</label>
                                </div>
                                <div class="col-md-7">
                                    <input class="form-control" type="number" id="THANG_GT_MPD" name="THANG_GT_MPD" onchange="sum_tong_truoc_vat();" placeholder="0" value="@(Model.THANG_GT_MPD??0)" disabled/>

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="float: left">3. Khác:</label>
                                </div>
                                <div class="col-md-7">
                                    <input class="form-control" type="number" id="THANG_GT_KHAC" name="THANG_GT_KHAC" onchange="sum_tong_truoc_vat();" placeholder="0" value="@(Model.THANG_GT_KHAC??0)" disabled/>

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="float: left;color: red;"><input type="radio" name="optradio" checked onclick="check_rdo_tong();"> Tổng/tháng(chưa VAT):</label>
                                </div>
                                <div class="col-md-7">
                                    <input type="number" id="THANG" class="form-control" name="THANG" />
                                    <input class="form-control" type="text" id="thang" onchange ="sum_tong();" placeholder="0" value="@Model.THANG" style="border-color: red;color: red;"/>
                                    
                                </div>
                            </div>
                            <div class="form-group" hidden>
                                <div class="control-label col-md-5">
                                    <label style="float: left">Thuế VAT:</label>
                                </div>
                                <div class="col-md-7">
                                    <select class="form-control" id="vat1" onchange="sum_tong();" name="VAT">
                                        <option value="0">0 %</option>
                                        <option value="5">5 %</option>
                                        <option value="10">10 %</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group" hidden>
                                <div class="control-label col-md-5">
                                    <label style="float: left">Tổng giá trị thuê/tháng:</label>
                                </div>
                                <div class="col-md-7">
                                    <input type="number" id="THANG_GT" class="form-control" name="THANG_GT" />                                    
                                    <input class="form-control" type="text" id="thang_gt" name="thang_gt" value="@Model.THANG_GT" disabled placeholder="0"/>                                 
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-5">
                                    <label style="float: left;">Tổng giá trị hợp đồng:</label>
                                </div>
                                <div class="col-md-7">
                                    <input type="number" id="TONG_GT" class="form-control" name="TONG_GT" placeholder="0" />
                                    <input class="form-control" type="text" id="tong_gt" value="@Model.TONG_GT" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Panel Thong tin khac-->
            <div class="col-md-6">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Thông tin khác</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group"></div>
                            <div class="form-group"></div>
                            <div class="form-group"></div>    
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Chu kỳ TT đầu:</label>
                                </div>
                                <div class="col-md-8">
                                    @Html.DropDownList("CHUKY_ID", (IEnumerable<SelectListItem>)ViewBag.CHUKYTT, "--Chọn chu kỳ TT--", new { @class = "form-control", required = "required", @id = "CHUKY_ID" })
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label  style="float: left">Các chu kỳ TT còn lại:</label>
                                </div>
                                <div class="col-md-8">
                                    @Html.DropDownList("CHUKY2_ID", (IEnumerable<SelectListItem>)ViewBag.CHUKYTT, "--Chọn chu kỳ TT--", new { @class = "form-control", required = "required", @id = "CHUKY2_ID" })
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Thời gian TT:</label>
                                </div>
                                <div class="col-md-8">
                                    @Html.DropDownList("THOIHAN_TT_ID", (IEnumerable<SelectListItem>)ViewBag.THOIHAN_TT, "--Chọn--", new { @class = "form-control", required = "required", @id = "THOIHAN_TT_ID" })
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Hình thức thanh toán:</label>
                                </div>
                                <div class="col-md-8">
                                    @Html.DropDownList("HTTT_ID", (IEnumerable<SelectListItem>)ViewBag.HINHTHUCTT, "--Chọn HTTT--", new { @class = "form-control", required = "required", @id = "HTTT_ID" })
                                </div>
                            </div>
                            <div class="form-group">
                                
                                <div class="control-label col-md-4">
                                    <label style="float: left">Hạn hợp đồng: </label>
                                </div>
                                <div class="col-md-8">
                                    <div class="form-group">
                                        <div class="control-label col-md-4">
                                            <label>Từ ngày:</label>
                                        </div>
                                        <div class="col-md-8">
                                            @if (Model.NGAY_BD.HasValue)
                                            {
                                                <input type="date" id="ngay_bd" class="form-control" name="NGAY_BD" value="@Model.NGAY_BD.Value.ToString("yyyy-MM-dd")" onchange="sum_tong2();" required="required"/>
                                            }
                                            else
                                            {
                                                <input type="date" class="form-control" name="NGAY_BD" required="required"/>
                                            }
                                        </div>
                                    </div>
                                    <div class="form-group">

                                        <div class="control-label col-md-4">
                                            <label>Đến ngày:</label>
                                        </div>
                                        <div class="col-md-8">
                                            @if (Model.NGAY_KT.HasValue)
                                            {
                                                <input type="date" id="ngay_kt" class="form-control" name="NGAY_KT" value="@Model.NGAY_KT.Value.ToString("yyyy-MM-dd")" onchange="sum_tong2();" />
                                            }
                                            else
                                            {
                                                <input type="date" class="form-control" name="NGAY_KT" />
                                            }
                                        </div>
                                    </div>                                    

                                </div>
                            </div>
                            <div class="form-group">
                                <div class="control-label col-md-4">
                                    <label style="float: left">Số chu kỳ thanh toán:</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" id="SO_CHUKY" class="form-control" value="@Model.SO_CHUKY" name="SO_CHUKY" />
                                </div>
                            </div>                           
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Ghi chú</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <div class="col-md-12">
                                    <textarea class="form-control" name="GHICHU" rows="4" placeholder="Ghi chú">@Model.GHICHU</textarea>
                                </div>
                                <a href="@Url.Action("ExportData", "HDChiPhi",new{@HDid = Model.HOPDONG_CHIPHI_ID} )"
                                        style="color:blue">
                                        @Model.File
                                    </a>
                                @*<button type="button" class="btn btn-success" data-toggle="modal" data-target="#update"><i class="fa fa-plus"></i>Cập nhật File HĐ</button>*@
                                <div class="form-group">
                                        <input type="file" class="form-control" id="upload" name="upload" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div style="text-align: center;">
                    <input type="submit" class="btn btn-success btn-lg" value="Cập nhật" id="submit" />
                    <a href="@Url.Action("Index", "HDChiPhi")" class="btn btn-default btn-lg">
                        Quay lại
                    </a>
                </div>
            </div>
            </div>
    }
</div>
@Html.Action("updateFile", "HDChiPhi", new {@idhd = @Model.HOPDONG_CHIPHI_ID })
@Scripts.Render("~/Scripts/numeric/jquery.js")
@Scripts.Render("~/Scripts/numeric/jquery.number.js")
<script type="text/javascript">
    $(function () {
        // Set up the number formatting.
        $('#THANG').hide();
        $('#TONG_GT').hide();
        $('#THANG_GT').hide();
        check_rdo_tong();

        $('#thang_gt').number(true, 0);
        //$('#vat').number(true, 0);
        //$('#thang').number(true, 0)
        $('#tong_gt').number(true, 0);

        $('#submit').on('click', function () {
            var thang_gt = $('#thang_gt').val();
            var thang = $('#thang').val();
            var tong = $('#tong_gt').val();
            $("input[name='THANG_GT']").val(thang_gt);
            $("input[name='TONG_GT']").val(tong);
            $("input[name='THANG']").val(thang);
        });
    });
    function sum_tong() {
        //alert("tesst");
        $('#THANG_GT_NHA_ANTEN').val(0);
        $('#THANG_GT_NHA').val(0);
        $('#THANG_GT_ANTEN').val(0);
        $('#THANG_GT_MPD').val(0);
        $('#THANG_GT_KHAC').val(0);
        var tong1 = 0;
        var thang1 = $('#thang').val();
        var vat1 = $('#vat1').val();
        var vat = (vat1 * thang1) / 100;
        tong1 = parseFloat(thang1) + parseFloat(vat);
        $("input[name='thang_gt']").val(tong1);
        sum_tong2();
        //alert(tong1);
    }

    function sum_tong2() {
        //var kt1 = $('#ngay_kt').val();
        //var bd1 = $('#ngay_bd').val();
        //var bd = new Date(bd1.replace(/(\d{2})[-/](\d{2})[-/](\d+)/, "$2/$1/$3"));
        //var kt = new Date(kt1.replace(/(\d{2})[-/](\d{2})[-/](\d+)/, "$2/$1/$3"));
        var bd = new Date($('#ngay_bd').val().toString('dd/MM/yyyy'));
        var kt = new Date($('#ngay_kt').val().toString('dd/MM/yyyy'));
        var sogiay = Math.abs(kt - bd);
        var sothang = Math.round(sogiay / (86400000 * 30));
        var tien = $('#thang_gt').val();
        var chuky = $('#CHUKY_ID').val();
        var chuky2 = $('#CHUKY2_ID').val();
        $.ajax({
            type: 'GET',
            url: '@Url.Action("getChuKyTT","HDChiPhi")',
                data: { chuky1: chuky, chuky2: chuky2 },
                success: function (data) {
                    var sochuky = Math.round((sothang - data.thang_dau) / data.thang_cuoi + 1);
                    var tong = tien * sothang;
                    $('#SO_CHUKY').val(sochuky);
                    $('#tong_gt').val(tong);
                }
            });
        }
</script>

<script type="text/javascript">
    $(function () {
        $("#loai_ct").val(@Model.LOAI_CT);
        $("#vat1").val(@Model.VAT);
    });
    $(document).ready(function () {
        $('#THUE_BT').change(function () {
            var id = $('#THUE_BT').val();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("getBT", "HDChiPhi")',
                data: { id: id },
                success: function (data) {
                    $('#TEN_BT').val(data.ten);
                    $('#DIACHI_BT').val(data.diachi);
                    $('#DT_BT1').val(data.dienthoai);
                    $('#MSTHUE_BT').val(data.msthue);
                    $('#TAIKHOAN_BT').val(data.taikhoan);
                    $('#NGANHANG_BT').val(data.nganhang);
                    $('#DAIDIEN_BT').val(data.daidien);
                    $('#CHUCVU_BT').val(data.chucvu);
                }
            });
        });
        @*$('#loai_ct').val("@Model.LOAI_CT");*@
        $('#loai_ct').change(function () {
            var id = $('#loai_ct').val();
            if (id == 1) {
                $('#cmnd_ct').hide();
                $('#ngaycap_ct').hide();
                $('#noicap_ct').hide();
                $('#ngaysinh_ct').hide();
                $('#daidien_ct').show();
                $('#chucvu_ct').show();
            }
            if (id == 2) {
                $('#daidien_ct').hide();
                $('#chucvu_ct').hide();
                $('#cmnd_ct').show();
                $('#ngaycap_ct').show();
                $('#noicap_ct').show();
                $('#ngaysinh_ct').show();
            }
        });
        
        $('#ngay_kt').change(function () {
        var thang = $('#thang_gt').val();
        var sochuky = $('#SO_CHUKY').val();
        var bd = new Date($('#ngay_bd').val().toString('dd/MM/yyyy'));
        var kt = new Date($('#ngay_kt').val().toString('dd/MM/yyyy'));
        var sogiay = Math.abs(kt - bd);
        var sothang = Math.round(sogiay / (86400000 * 30));
        var tong = thang * sothang;
        $('#tong_gt').val(tong);
        });
    });
</script>
@*Load cac properties multi*@
<script type="text/javascript">
        $(document).ready(function() {
            $('#BTS_ID').multiselect({
            includeSelectAllOption: true,
            buttonWidth: 250,
            enableFiltering: true
        });
        }); 
        var arrBtsId = $('#BTS_ID_STR').val().split(",");
        $('#BTS_ID').val(arrBtsId);
</script>
@*Update new data*@
<script type="text/javascript">
    $('#BTS_ID').on('change', function () {
        var selected = $(this).find("option:selected");
        var arrSelected = [];
        selected.each((idx, val) => {
            arrSelected.push(val.value);
        });
        $('#BTS_ID_STR').val(arrSelected.join());
    });
    //tinh Tong Nha+anten
    function sum_nha_anten() {
        var sum_nha_anten = parseFloat($('#THANG_GT_NHA').val()) + parseFloat($('#THANG_GT_ANTEN').val());
        $('#THANG_GT_NHA_ANTEN').val(sum_nha_anten);
        sum_tong_truoc_vat();
    }
    
    //Reset lai tag nha & tag anten khi nhap sum_nha_anten
    function reset_sum_nha_anten() {
        $('#THANG_GT_NHA').val(0);
        $('#THANG_GT_ANTEN').val(0);
        sum_tong_truoc_vat();
    }
    //Reset lai tag nha & tag anten khi nhap sum_nha_anten
    function sum_tong_truoc_vat() {
        var sum_tong_truoc_vat = parseFloat($('#THANG_GT_NHA_ANTEN').val()) + parseFloat($('#THANG_GT_MPD').val()) + parseFloat($('#THANG_GT_KHAC').val());
        $('#thang').val(sum_tong_truoc_vat);
        var tong1 = 0;
        var thang1 = $('#thang').val();
        var vat1 = $('#vat1').val();
        var vat = (vat1 * thang1) / 100;
        tong1 = parseFloat(thang1) + parseFloat(vat);
        $("input[name='thang_gt']").val(tong1);
        sum_tong2();
    }
    //Click radio chi tiet
    function check_rdo_ct() {
        $("#thang").prop('disabled', true);
        $("#THANG_GT_NHA_ANTEN").prop('disabled', false);
        $("#THANG_GT_NHA").prop('disabled', false);
        $("#THANG_GT_ANTEN").prop('disabled', false);
        $("#THANG_GT_MPD").prop('disabled', false);
        $("#THANG_GT_KHAC").prop('disabled', false);
    }
    //Click radio Tong
    function check_rdo_tong() {

        $("#thang").prop('disabled', false);
        $("#THANG_GT_NHA_ANTEN").prop('disabled', true);
        $("#THANG_GT_NHA").prop('disabled', true);
        $("#THANG_GT_ANTEN").prop('disabled', true);
        $("#THANG_GT_MPD").prop('disabled', true);
        $("#THANG_GT_KHAC").prop('disabled', true);
    }
    $('#CHUKY_ID').on('change', function () {
        sum_tong2();
    });
    $('#CHUKY2_ID').on('change', function () {
        sum_tong2();
    });
    $('#THOIHAN_TT_ID').on('change', function () {
        sum_tong2();
    });
    $('#HTTT_ID').on('change', function () {
        sum_tong2();
    });
</script>